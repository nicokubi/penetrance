"0","# Function to calculate penetrance with confidence intervals"
"0","calculate_penetrance <- function(data, ages = c(30, 40, 50, 60, 65, 70), sex = ""NA"") {"
"0","  params_male <- calculate_weibull_parameters("
"0","    data$median_male_results,"
"0","    data$first_quartile_male_results,"
"0","    data$threshold_male_results"
"0","  )"
"0",""
"0","  params_female <- calculate_weibull_parameters("
"0","    data$median_female_results,"
"0","    data$first_quartile_female_results,"
"0","    data$threshold_female_results"
"0","  )"
"0",""
"0","  alphas_male <- params_male$alpha"
"0","  betas_male <- params_male$beta"
"0","  thresholds_male <- data$threshold_male_results"
"0","  alphas_female <- params_female$alpha"
"0","  betas_female <- params_female$beta"
"0","  thresholds_female <- data$threshold_female_results"
"0",""
"0","  asymptotes_male <- data$asymptote_male_results"
"0","  asymptotes_female <- data$asymptote_female_results"
"0",""
"0","  cumulative_prob <- function(alphas, betas, thresholds, asymptotes, age) {"
"0","    probs <- mapply(function(alpha, beta, threshold, asymptote) {"
"0","      pweibull(age - threshold, shape = alpha, scale = beta) * asymptote"
"0","    }, alphas, betas, thresholds, asymptotes, SIMPLIFY = FALSE)"
"0","    mean_prob <- mean(unlist(probs), na.rm = TRUE)"
"0","    ci_lower <- quantile(unlist(probs), probs = 0.025, na.rm = TRUE)"
"0","    ci_upper <- quantile(unlist(probs), probs = 0.975, na.rm = TRUE)"
"0","    return(list(mean = mean_prob, lower = ci_lower, upper = ci_upper))"
"0","  }"
"0",""
"0","  results <- list()"
"0",""
"0","  if (sex == ""Male"" || sex == ""NA"") {"
"0","    results$Male <- sapply(ages, function(age) cumulative_prob(alphas_male, betas_male, thresholds_male, asymptotes_male, age))"
"0","  }"
"0",""
"0","  if (sex == ""Female"" || sex == ""NA"") {"
"0","    results$Female <- sapply(ages, function(age) cumulative_prob(alphas_female, betas_female, thresholds_female, asymptotes_female, age))"
"0","  }"
"0",""
"0","  return(results)"
"0","}"
"0",""
"0",""
"0","# Calculate penetrance results"
"0","penetrance_results <- calculate_penetrance(dat$combined_chains)"
"0",""
"0","# Format results for LaTeX"
"0","ages <- c(30, 40, 50, 60, 65, 70)"
"0","results_male <- penetrance_results$Male"
"0","results_female <- penetrance_results$Female"
"0","print(results_female)"
"1","     "
"1"," [,1]       "
"1"," [,2]      "
"1"," [,3]      "
"1"," [,4]      "
"1"," [,5]      "
"1"," [,6]      "
"1","
mean "
"1"," 0.009501512"
"1"," 0.0221694 "
"1"," 0.03770167"
"1"," 0.05409729"
"1"," 0.06204895"
"1"," 0.06960238"
"1","
lower"
"1"," 0.004819021"
"1"," 0.01431834"
"1"," 0.02703968"
"1"," 0.03877895"
"1"," 0.04409465"
"1"," 0.04848679"
"1","
upper"
"1"," 0.0154171  "
"1"," 0.03151043"
"1"," 0.0512454 "
"1"," 0.07322418"
"1"," 0.08426246"
"1"," 0.09561623"
"1","
"
"0","print(results_male)"
"1","     "
"1"," [,1]       "
"1"," [,2]      "
"1"," [,3]      "
"1"," [,4]      "
"1"," [,5]      "
"1"," [,6]      "
"1","
mean "
"1"," 0.01439626 "
"1"," 0.03054671"
"1"," 0.05133914"
"1"," 0.07484234"
"1"," 0.08691897"
"1"," 0.09885181"
"1","
lower"
"1"," 0.008266578"
"1"," 0.02084233"
"1"," 0.03664246"
"1"," 0.05428765"
"1"," 0.06250441"
"1"," 0.06961656"
"1","
upper"
"1"," 0.02120715 "
"1"," 0.04140591"
"1"," 0.06730088"
"1"," 0.09732502"
"1"," 0.1139629 "
"1"," 0.1313322 "
"1","
"
