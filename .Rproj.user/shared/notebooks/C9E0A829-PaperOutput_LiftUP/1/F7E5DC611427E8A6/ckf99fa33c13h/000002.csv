"0","# Function to calculate penetrance with confidence intervals"
"0","calculate_penetrance <- function(data, ages = c(30, 40, 50, 60, 65, 70), sex = ""NA"") {"
"0","  params_male <- calculate_weibull_parameters("
"0","    data$median_male_results,"
"0","    data$first_quartile_male_results,"
"0","    data$threshold_male_results"
"0","  )"
"0",""
"0","  params_female <- calculate_weibull_parameters("
"0","    data$median_female_results,"
"0","    data$first_quartile_female_results,"
"0","    data$threshold_female_results"
"0","  )"
"0",""
"0","  alphas_male <- params_male$alpha"
"0","  betas_male <- params_male$beta"
"0","  thresholds_male <- data$threshold_male_results"
"0","  alphas_female <- params_female$alpha"
"0","  betas_female <- params_female$beta"
"0","  thresholds_female <- data$threshold_female_results"
"0",""
"0","  asymptotes_male <- data$asymptote_male_results"
"0","  asymptotes_female <- data$asymptote_female_results"
"0",""
"0","  cumulative_prob <- function(alphas, betas, thresholds, asymptotes, age) {"
"0","    probs <- mapply(function(alpha, beta, threshold, asymptote) {"
"0","      pweibull(age - threshold, shape = alpha, scale = beta) * asymptote"
"0","    }, alphas, betas, thresholds, asymptotes, SIMPLIFY = FALSE)"
"0","    mean_prob <- mean(unlist(probs), na.rm = TRUE)"
"0","    ci_lower <- quantile(unlist(probs), probs = 0.025, na.rm = TRUE)"
"0","    ci_upper <- quantile(unlist(probs), probs = 0.975, na.rm = TRUE)"
"0","    return(list(mean = mean_prob, lower = ci_lower, upper = ci_upper))"
"0","  }"
"0",""
"0","  results <- list()"
"0",""
"0","  if (sex == ""Male"" || sex == ""NA"") {"
"0","    results$Male <- sapply(ages, function(age) cumulative_prob(alphas_male, betas_male, thresholds_male, asymptotes_male, age))"
"0","  }"
"0",""
"0","  if (sex == ""Female"" || sex == ""NA"") {"
"0","    results$Female <- sapply(ages, function(age) cumulative_prob(alphas_female, betas_female, thresholds_female, asymptotes_female, age))"
"0","  }"
"0",""
"0","  return(results)"
"0","}"
"0",""
"0",""
"0","# Calculate penetrance results"
"0","penetrance_results <- calculate_penetrance(dat$combined_chains)"
"0",""
"0","# Format results for LaTeX"
"0","ages <- c(30, 40, 50, 60, 65, 70)"
"0","results_male <- penetrance_results$Male"
"0","results_female <- penetrance_results$Female"
"0","print(results_female)"
"1","     "
"1"," [,1]     "
"1"," [,2]     "
"1"," [,3]     "
"1"," [,4]     "
"1"," [,5]     "
"1"," [,6]     "
"1","
mean "
"1"," 0.1302306"
"1"," 0.3052917"
"1"," 0.4802069"
"1"," 0.6166491"
"1"," 0.6663358"
"1"," 0.7043822"
"1","
lower"
"1"," 0.107767 "
"1"," 0.2764163"
"1"," 0.4436395"
"1"," 0.5805644"
"1"," 0.6332191"
"1"," 0.6744062"
"1","
upper"
"1"," 0.1555075"
"1"," 0.3328173"
"1"," 0.5196844"
"1"," 0.6729337"
"1"," 0.7260923"
"1"," 0.7648049"
"1","
"
"0","print(results_male)"
"1","     "
"1"," [,1]       "
"1"," [,2]       "
"1"," [,3]       "
"1"," [,4]       "
"1"," [,5]       "
"1"," [,6]       "
"1","
mean "
"1"," 0.004115467"
"1"," 0.004786606"
"1"," 0.005257778"
"1"," 0.005622326"
"1"," 0.005777832"
"1"," 0.005919654"
"1","
lower"
"1"," 0.001686248"
"1"," 0.001920929"
"1"," 0.00208462 "
"1"," 0.002210849"
"1"," 0.002264625"
"1"," 0.002313648"
"1","
upper"
"1"," 0.009019704"
"1"," 0.01054365 "
"1"," 0.01161527 "
"1"," 0.01244521 "
"1"," 0.01279942 "
"1"," 0.01312253 "
"1","
"
