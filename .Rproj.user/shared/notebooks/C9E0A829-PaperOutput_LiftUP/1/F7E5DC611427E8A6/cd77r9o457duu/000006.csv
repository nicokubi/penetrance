"0","# Function to plot trace of log posterior"
"0","plot_trace_log_posterior <- function(mcmc_results) {"
"0","  # Assuming mcmc_results contains columns for log prior and log likelihood"
"0","  log_prior <- mcmc_results$logprior_current"
"0","  log_likelihood <- mcmc_results$loglikelihood_current"
"0","  "
"0","  # Calculate log posterior"
"0","  log_posterior <- log_prior + log_likelihood"
"0","  "
"0","  # Create a data frame for plotting"
"0","  trace_df <- data.frame("
"0","    Iteration = seq_along(log_posterior),"
"0","    LogPrior = log_prior,"
"0","    LogLikelihood = log_likelihood,"
"0","    LogPosterior = log_posterior"
"0","  )"
"0","  "
"0","  # Plot the trace"
"0","  ggplot(trace_df, aes(x = Iteration)) +"
"0","    geom_line(aes(y = LogPosterior, color = ""Log Posterior"")) +"
"0","    geom_line(aes(y = LogLikelihood, color = ""Log Likelihood"")) +"
"0","    labs(title = ""Trace Plots"","
"0","         x = ""Iteration"","
"0","         y = ""Log Value"") +"
"0","    theme_minimal() +"
"0","    scale_color_manual(values = c(""Log Likelihood"" = ""blue"", ""Log Posterior"" = ""red"")) +"
"0","    theme(legend.title = element_blank())"
"0","}"
"0",""
"0","# Example usage"
"0","plot_trace_log_posterior(dat_noImp$results[[1]])"
