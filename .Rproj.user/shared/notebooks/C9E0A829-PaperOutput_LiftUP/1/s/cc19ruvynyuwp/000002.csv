"0","# Function to calculate penetrance with confidence intervals"
"0","calculate_penetrance <- function(data, ages = c(30, 40, 50, 60, 65, 70), sex = ""NA"") {"
"0","  params_male <- calculate_weibull_parameters("
"0","    data$median_male_results,"
"0","    data$first_quartile_male_results,"
"0","    data$threshold_male_results"
"0","  )"
"0",""
"0","  params_female <- calculate_weibull_parameters("
"0","    data$median_female_results,"
"0","    data$first_quartile_female_results,"
"0","    data$threshold_female_results"
"0","  )"
"0",""
"0","  alphas_male <- params_male$alpha"
"0","  betas_male <- params_male$beta"
"0","  thresholds_male <- data$threshold_male_results"
"0","  alphas_female <- params_female$alpha"
"0","  betas_female <- params_female$beta"
"0","  thresholds_female <- data$threshold_female_results"
"0",""
"0","  asymptotes_male <- data$asymptote_male_results"
"0","  asymptotes_female <- data$asymptote_female_results"
"0",""
"0","  cumulative_prob <- function(alphas, betas, thresholds, asymptotes, age) {"
"0","    probs <- mapply(function(alpha, beta, threshold, asymptote) {"
"0","      pweibull(age - threshold, shape = alpha, scale = beta) * asymptote"
"0","    }, alphas, betas, thresholds, asymptotes, SIMPLIFY = FALSE)"
"0","    mean_prob <- mean(unlist(probs), na.rm = TRUE)"
"0","    ci_lower <- quantile(unlist(probs), probs = 0.025, na.rm = TRUE)"
"0","    ci_upper <- quantile(unlist(probs), probs = 0.975, na.rm = TRUE)"
"0","    return(list(mean = mean_prob, lower = ci_lower, upper = ci_upper))"
"0","  }"
"0",""
"0","  results <- list()"
"0",""
"0","  if (sex == ""Male"" || sex == ""NA"") {"
"0","    results$Male <- sapply(ages, function(age) cumulative_prob(alphas_male, betas_male, thresholds_male, asymptotes_male, age))"
"0","  }"
"0",""
"0","  if (sex == ""Female"" || sex == ""NA"") {"
"0","    results$Female <- sapply(ages, function(age) cumulative_prob(alphas_female, betas_female, thresholds_female, asymptotes_female, age))"
"0","  }"
"0",""
"0","  return(results)"
"0","}"
"0",""
"0",""
"0","# Calculate penetrance results"
"0","penetrance_results <- calculate_penetrance(dat$combined_chains)"
"0",""
"0","# Format results for LaTeX"
"0","ages <- c(30, 40, 50, 60, 65, 70)"
"0","results_male <- penetrance_results$Male"
"0","results_female <- penetrance_results$Female"
"0","print(results_female)"
"1","     "
"1"," [,1]       "
"1"," [,2]      "
"1"," [,3]      "
"1"," [,4]      "
"1"," [,5]      "
"1"," [,6]      "
"1","
mean "
"1"," 0.004861395"
"1"," 0.01198823"
"1"," 0.02002665"
"1"," 0.02803386"
"1"," 0.03183223"
"1"," 0.03542876"
"1","
lower"
"1"," 0.002884246"
"1"," 0.00853905"
"1"," 0.01464019"
"1"," 0.02012468"
"1"," 0.02271269"
"1"," 0.02516655"
"1","
upper"
"1"," 0.006651807"
"1"," 0.01616671"
"1"," 0.02720765"
"1"," 0.03738368"
"1"," 0.04286385"
"1"," 0.04852484"
"1","
"
"0","print(results_male)"
"1","     "
"1"," [,1]       "
"1"," [,2]      "
"1"," [,3]      "
"1"," [,4]      "
"1"," [,5]      "
"1"," [,6]      "
"1","
mean "
"1"," 0.01025824 "
"1"," 0.02108229"
"1"," 0.03179483"
"1"," 0.04111672"
"1"," 0.04507135"
"1"," 0.04853067"
"1","
lower"
"1"," 0.006163186"
"1"," 0.01598596"
"1"," 0.02500577"
"1"," 0.03336466"
"1"," 0.03640619"
"1"," 0.03868299"
"1","
upper"
"1"," 0.01602135 "
"1"," 0.03063875"
"1"," 0.04441525"
"1"," 0.05618034"
"1"," 0.06123798"
"1"," 0.06677434"
"1","
"
