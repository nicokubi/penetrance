"0","# Function to calculate penetrance with confidence intervals"
"0","calculate_penetrance <- function(data, ages = c(30, 40, 50, 60, 65, 70), sex = ""NA"") {"
"0","  params_male <- calculate_weibull_parameters("
"0","    data$median_male_results,"
"0","    data$first_quartile_male_results,"
"0","    data$threshold_male_results"
"0","  )"
"0",""
"0","  params_female <- calculate_weibull_parameters("
"0","    data$median_female_results,"
"0","    data$first_quartile_female_results,"
"0","    data$threshold_female_results"
"0","  )"
"0",""
"0","  alphas_male <- params_male$alpha"
"0","  betas_male <- params_male$beta"
"0","  thresholds_male <- data$threshold_male_results"
"0","  alphas_female <- params_female$alpha"
"0","  betas_female <- params_female$beta"
"0","  thresholds_female <- data$threshold_female_results"
"0",""
"0","  asymptotes_male <- data$asymptote_male_results"
"0","  asymptotes_female <- data$asymptote_female_results"
"0",""
"0","  cumulative_prob <- function(alphas, betas, thresholds, asymptotes, age) {"
"0","    probs <- mapply(function(alpha, beta, threshold, asymptote) {"
"0","      pweibull(age - threshold, shape = alpha, scale = beta) * asymptote"
"0","    }, alphas, betas, thresholds, asymptotes, SIMPLIFY = FALSE)"
"0","    mean_prob <- mean(unlist(probs), na.rm = TRUE)"
"0","    ci_lower <- quantile(unlist(probs), probs = 0.025, na.rm = TRUE)"
"0","    ci_upper <- quantile(unlist(probs), probs = 0.975, na.rm = TRUE)"
"0","    return(list(mean = mean_prob, lower = ci_lower, upper = ci_upper))"
"0","  }"
"0",""
"0","  results <- list()"
"0",""
"0","  if (sex == ""Male"" || sex == ""NA"") {"
"0","    results$Male <- sapply(ages, function(age) cumulative_prob(alphas_male, betas_male, thresholds_male, asymptotes_male, age))"
"0","  }"
"0",""
"0","  if (sex == ""Female"" || sex == ""NA"") {"
"0","    results$Female <- sapply(ages, function(age) cumulative_prob(alphas_female, betas_female, thresholds_female, asymptotes_female, age))"
"0","  }"
"0",""
"0","  return(results)"
"0","}"
"0",""
"0",""
"0","# Calculate penetrance results"
"0","penetrance_results <- calculate_penetrance(dat$combined_chains)"
"0",""
"0","# Format results for LaTeX"
"0","ages <- c(30, 40, 50, 60, 65, 70)"
"0","results_male <- penetrance_results$Male"
"0","results_female <- penetrance_results$Female"
"0","print(results_female)"
"1","     "
"1"," [,1]      "
"1"," [,2]      "
"1"," [,3]     "
"1"," [,4]     "
"1"," [,5]     "
"1"," [,6]     "
"1","
mean "
"1"," 0.02993221"
"1"," 0.09494058"
"1"," 0.1816583"
"1"," 0.2746645"
"1"," 0.3192435"
"1"," 0.3608451"
"1","
lower"
"1"," 0.01922267"
"1"," 0.07362424"
"1"," 0.147454 "
"1"," 0.2285816"
"1"," 0.2663571"
"1"," 0.2995591"
"1","
upper"
"1"," 0.04248729"
"1"," 0.118277  "
"1"," 0.215228 "
"1"," 0.3245391"
"1"," 0.3772852"
"1"," 0.4271181"
"1","
"
"0","print(results_male)"
"1","     "
"1"," [,1]      "
"1"," [,2]      "
"1"," [,3]     "
"1"," [,4]     "
"1"," [,5]     "
"1"," [,6]     "
"1","
mean "
"1"," 0.02819788"
"1"," 0.1038849 "
"1"," 0.2121575"
"1"," 0.3246016"
"1"," 0.3741115"
"1"," 0.4165556"
"1","
lower"
"1"," 0.01763795"
"1"," 0.07939411"
"1"," 0.1749056"
"1"," 0.2733331"
"1"," 0.3180618"
"1"," 0.3555371"
"1","
upper"
"1"," 0.04121553"
"1"," 0.1280006 "
"1"," 0.2509399"
"1"," 0.377546 "
"1"," 0.4357265"
"1"," 0.4833761"
"1","
"
