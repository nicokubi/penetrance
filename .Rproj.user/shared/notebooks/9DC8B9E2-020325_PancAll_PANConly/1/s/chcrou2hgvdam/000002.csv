"0",""
"0","# Use the SEER baseline"
"0","baseline <- PPP::PanelPRODatabase$Penetrance[""Pancreas"",""SEER"",""All_Races"",,,""Net""]"
"0","# Adjust Format"
"0","baseline_df <- as.data.frame(t(baseline))"
"0","colnames(baseline_df) <- c(""Female"", ""Male"")"
"0","baseline_df$Age <- as.numeric(rownames(baseline_df))"
"0","baseline_df <- baseline_df[, c(""Age"",""Female"", ""Male"")]"
"0",""
"0",""
"0","# 1) Define genes of interest"
"0","# Genes of interest"
"0","target_genes <- c(""BRCA1"", ""BRCA2"", ""PALB2"", ""CDKN2A[P16]"", ""ATM"")"
"0",""
"0","# Extract the allele frequency for each gene (e.g., in the 'nonAJ' population)"
"0","freq_vec <- sapply(target_genes, function(gene) {"
"0","  PPP::PanelPRODatabase$AlleleFrequency[paste0(gene, ""_anyPV""), ""nonAJ""]"
"0","})"
"0",""
"0","# Calculate the probability that an individual is NOT a carrier for each gene"
"0","# (under the ""dominant"" assumption => 'not carrier' = (1-p)^2)"
"0","not_carrier_vec <- (1 - 2*freq_vec)"
"0",""
"0","# Probability that an individual carries NONE of the 5 variants"
"0","prob_none <- prod(not_carrier_vec)"
"0",""
"0","# Probability that an individual carries AT LEAST ONE of the 5 variants"
"0","prob_any <- 1 - prob_none"
"0",""
"0",""
"0","#Run Estimation procedure with default prior setting "
"0","system.time(out_Panc_onlyfirst2 <- penetrance("
"0","    pedigree  = dat, twins = NULL, n_chains = 1, n_iter_per_chain = 100, ncores = 4, imp_interval = 1,"
"0","    baseline_data = baseline_df, prev = prob_any,  "
"0","    prior_params = prior_params_default, burn_in = 0.1, median_max = TRUE, thinning_factor = 1,"
"0","    age_imputation = FALSE, remove_proband = TRUE, sex_specific = TRUE"
"0","))"
"2","Warning in penetrance(pedigree = dat, twins = NULL, n_chains = 1, n_iter_per_chain = 100,  :"
"2","
 "
"2"," Low acceptance rate. Please consider running the chain longer.
"
"1","Rejection rates: "
"1"," "
"1","0.94"
"1"," "
"1","
"
"1",""
"1","  Median_Male   "
"1"," Median_Female  "
"1"," Threshold_Male "
"1"," Threshold_Female"
"1"," First_Quartile_Male"
"1","
"
"1"," Min.   :59.36  "
"1"," Min.   :65.28  "
"1"," Min.   :15.93  "
"1"," Min.   :16.33   "
"1"," Min.   :17.79      "
"1","
"
"1"," 1st Qu.:59.36  "
"1"," 1st Qu.:65.56  "
"1"," 1st Qu.:15.93  "
"1"," 1st Qu.:16.33   "
"1"," 1st Qu.:17.79      "
"1","
"
"1"," Median :59.46  "
"1"," Median :65.86  "
"1"," Median :16.08  "
"1"," Median :16.38   "
"1"," Median :17.94      "
"1","
"
"1"," Mean   :59.49  "
"1"," Mean   :65.79  "
"1"," Mean   :16.19  "
"1"," Mean   :16.43   "
"1"," Mean   :18.01      "
"1","
"
"1"," 3rd Qu.:59.57  "
"1"," 3rd Qu.:65.86  "
"1"," 3rd Qu.:16.51  "
"1"," 3rd Qu.:16.46   "
"1"," 3rd Qu.:18.21      "
"1","
"
"1"," Max.   :59.87  "
"1"," Max.   :66.19  "
"1"," Max.   :16.77  "
"1"," Max.   :16.66   "
"1"," Max.   :18.62      "
"1","
"
"1",""
"1"," First_Quartile_Female"
"1"," Asymptote_Male   "
"1"," Asymptote_Female  "
"1","
"
"1"," Min.   :37.71        "
"1"," Min.   :0.05872  "
"1"," Min.   :0.001366  "
"1","
"
"1"," 1st Qu.:38.00        "
"1"," 1st Qu.:0.05872  "
"1"," 1st Qu.:0.001366  "
"1","
"
"1"," Median :38.00        "
"1"," Median :0.08686  "
"1"," Median :0.010169  "
"1","
"
"1"," Mean   :38.09        "
"1"," Mean   :0.10341  "
"1"," Mean   :0.011127  "
"1","
"
"1"," 3rd Qu.:38.40        "
"1"," 3rd Qu.:0.12897  "
"1"," 3rd Qu.:0.012671  "
"1","
"
"1"," Max.   :38.40        "
"1"," Max.   :0.20066  "
"1"," Max.   :0.034006  "
"1","
"
