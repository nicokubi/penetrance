"0",""
"0","# Use the SEER baseline"
"0","baseline <- PPP::PanelPRODatabase$Penetrance[""Pancreas"",""SEER"",""All_Races"",,,""Net""]"
"0","# Adjust Format"
"0","baseline_df <- as.data.frame(t(baseline))"
"0","colnames(baseline_df) <- c(""Female"", ""Male"")"
"0","baseline_df$Age <- as.numeric(rownames(baseline_df))"
"0","baseline_df <- baseline_df[, c(""Age"",""Female"", ""Male"")]"
"0",""
"0",""
"0","# 1) Define genes of interest"
"0","# Genes of interest"
"0","target_genes <- c(""BRCA1"", ""BRCA2"", ""PALB2"", ""CDKN2A[P16]"", ""ATM"")"
"0",""
"0","# Extract the allele frequency for each gene (e.g., in the 'nonAJ' population)"
"0","freq_vec <- sapply(target_genes, function(gene) {"
"0","  PPP::PanelPRODatabase$AlleleFrequency[paste0(gene, ""_anyPV""), ""nonAJ""]"
"0","})"
"0",""
"0","# Calculate the probability that an individual is NOT a carrier for each gene"
"0","# (under the ""dominant"" assumption => 'not carrier' = (1-p)^2)"
"0","not_carrier_vec <- (1 - 2*freq_vec)"
"0",""
"0","# Probability that an individual carries NONE of the 5 variants"
"0","prob_none <- prod(not_carrier_vec)"
"0",""
"0","# Probability that an individual carries AT LEAST ONE of the 5 variants"
"0","prob_any <- 1 - prob_none"
"0",""
"0",""
"0","#Run Estimation procedure with default prior setting "
"0","system.time(out_Panc_onlyfirst2 <- penetrance("
"0","    pedigree  = dat, twins = NULL, n_chains = 1, n_iter_per_chain = 100, ncores = 4, imp_interval = 1,"
"0","    baseline_data = baseline_df, prev = prob_any,  "
"0","    prior_params = prior_params_default, burn_in = 0.1, median_max = TRUE, thinning_factor = 1,"
"0","    age_imputation = FALSE, remove_proband = TRUE, sex_specific = TRUE"
"0","))"
