"0",""
"0","# Create age groups"
"0","flat_data$age_group <- cut(flat_data$CurAge,"
"0","                          breaks = c(0, 20, 30, 40, 50, 60, 70, 80, 90),"
"0","                          labels = c(""<20"", ""20-29"", ""30-39"", ""40-49"", ""50-59"", ""60-69"", ""70-79"", ""80+""),"
"0","                          include.lowest = TRUE)"
"0",""
"0","# Calculate prevalence by age group and carrier status"
"0","prevalence_data <- flat_data %>%"
"0","  filter(!is.na(age_group) & !is.na(carrier_status)) %>%"
"0","  group_by(age_group, carrier_status) %>%"
"0","  summarize("
"0","    total = n(),"
"0","    affected = sum(affected_status == ""Affected"", na.rm = TRUE),"
"0","    prevalence = affected / total"
"0","  )"
"1","[38;5;252m`summarise()` has grouped output by 'age_group'. You can override using the `.groups` argument.[39m
"
"0","# Plot prevalence by age group and carrier status"
"0","ggplot(prevalence_data, aes(x = age_group, y = prevalence, fill = carrier_status, group = carrier_status)) +"
"0","  geom_bar(stat = ""identity"", position = position_dodge(width = 0.9), alpha = 0.7) +"
"0","  geom_text(aes(label = sprintf(""%.1f%%"", prevalence * 100)),"
"0","           position = position_dodge(width = 0.9),"
"0","           vjust = -0.5, size = 3) +"
"0","  labs(title = ""Colorectal Cancer Prevalence by Age Group and Carrier Status"","
"0","       x = ""Age Group"", y = ""Prevalence"") +"
"0","  scale_y_continuous(labels = scales::percent) +"
"0","  scale_fill_brewer(palette = ""Set1"") +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
