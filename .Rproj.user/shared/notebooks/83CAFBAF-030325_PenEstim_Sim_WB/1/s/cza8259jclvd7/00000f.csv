"0","# Create parameter posterior density plots for visual assessment"
"0","create_parameter_density_plots <- function() {"
"0","  # Extract posterior samples for a parameter"
"0","  extract_posterior <- function(param_name, sex) {"
"0","    posteriors <- data.frame()"
"0","    "
"0","    for (size in sample_sizes) {"
"0","      name <- paste0(""n"", size)"
"0","      if (!is.null(all_params[[name]])) {"
"0","        # Extract samples"
"0","        samples <- all_params[[name]]$samples[[paste0(param_name, ""_"", sex)]]"
"0","        if (!is.null(samples)) {"
"0","          size_data <- data.frame("
"0","            SampleSize = as.factor(size),"
"0","            Value = samples"
"0","          )"
"0","          posteriors <- rbind(posteriors, size_data)"
"0","        }"
"0","      }"
"0","    }"
"0","    "
"0","    return(posteriors)"
"0","  }"
"0","  "
"0","  # Extract posteriors for key parameters"
"0","  asymptote_m_posterior <- extract_posterior(""asymptote"", ""male"")"
"0","  asymptote_f_posterior <- extract_posterior(""asymptote"", ""female"")"
"0","  "
"0","  # Plot densities for male asymptote"
"0","  p1 <- ggplot(asymptote_m_posterior, aes(x = Value, fill = SampleSize)) +"
"0","    geom_density(alpha = 0.4) +"
"0","    labs(title = ""Male Asymptote Posterior"", x = ""Value"", y = ""Density"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""bottom"")"
"0","  "
"0","  # Plot densities for female asymptote"
"0","  p2 <- ggplot(asymptote_f_posterior, aes(x = Value, fill = SampleSize)) +"
"0","    geom_density(alpha = 0.4) +"
"0","    labs(title = ""Female Asymptote Posterior"", x = ""Value"", y = ""Density"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""bottom"")"
"0","  "
"0","  return(list(p1 = p1, p2 = p2))"
"0","}"
"0",""
"0","# Generate and display density plots"
"0","density_plots <- create_parameter_density_plots()"
"0","gridExtra::grid.arrange(density_plots$p1, density_plots$p2, ncol = 2)"
