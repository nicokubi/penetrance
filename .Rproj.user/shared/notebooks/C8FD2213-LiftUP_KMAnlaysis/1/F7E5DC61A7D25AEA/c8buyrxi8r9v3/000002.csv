"0","# Function to convert columns to the required format"
"0","convert_pedigree_format <- function(dat) {"
"0","  # Loop through each pedigree in the list"
"0","  for (i in seq_along(dat)) {"
"0","    # Rename columns according to the required format"
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Pedigree.name""] <- ""PedigreeID"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""UPN""] <- ""ID"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Gender""] <- ""Sex"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Mother.ID""] <- ""MotherID"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Father.ID""] <- ""FatherID"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""proband_flag_x""] <- ""isProband"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Age""] <- ""CurAge"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Colorectal""] <- ""isAff"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""Colorectal_age_dx""] <- ""Age"""
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""GT.Pos""] <- ""geno"""
"0","    "
"0","     # Calculate CurAge only if it is currently NA"
"0","    dat[[i]]$CurAge <- ifelse(is.na(dat[[i]]$CurAge),"
"0","                              dat[[i]]$Year_Last_FolUp - dat[[i]]$Year_Birth,"
"0","                              dat[[i]]$CurAge)"
"0",""
"0","  }"
"0","  "
"0","  # Return the modified data"
"0","  return(dat)"
"0","}"
"0",""
"0","# Example usage with your list of pedigrees"
"0","dat_adjusted <- convert_pedigree_format(dat)"
"0",""
"0","# Iterate through each data frame in the list dat"
"0","for (i in seq_along(dat_adjusted)) {"
"0","  "
"0","   # Convert ""Sex"" to numeric where ""M"" is 1 and ""F"" is 0"
"0","  dat_adjusted[[i]]$Sex <- ifelse(dat_adjusted[[i]]$Sex == ""M"", 1, ifelse(dat_adjusted[[i]]$Sex == ""F"", 0, NA))"
"0","  "
"0","  # Remove rows where Sex is NA"
"0","  dat_adjusted[[i]] <- dat_adjusted[[i]][!is.na(dat_adjusted[[i]]$Sex), ]"
"0",""
"0","  # Convert ""isProband"" to numeric where ""proband"" is 1, and all other values are 0"
"0","  dat_adjusted[[i]]$isProband <- ifelse(dat_adjusted[[i]]$isProband == ""proband"", 1, 0)"
"0","  "
"0","  # Convert ""isAff"" to numeric where ""True"" is 1, and anything else (including NA) is 0"
"0","  dat_adjusted[[i]]$isAff[is.na(dat_adjusted[[i]]$isAff)] <- 0"
"0","  dat_adjusted[[i]]$isAff <- ifelse(dat_adjusted[[i]]$isAff == ""True"", 1, 0)"
"0","  "
"0","   #Adjust ""geno"" column: ""True"" = 1, ""False"" = 0, NA if unknown"
"0","  dat_adjusted[[i]]$geno <- ifelse(dat_adjusted[[i]]$geno == ""True"", 1,"
"0","                                   ifelse(dat_adjusted[[i]]$geno == ""False"", 0, NA))"
"0",""
"0","  # Ensure ""CurAge"" and ""Age"" are within allowed range (1 to 94)"
"0","  dat_adjusted[[i]]$CurAge <- ifelse(dat_adjusted[[i]]$CurAge > 94, 94, dat_adjusted[[i]]$CurAge)"
"0","  dat_adjusted[[i]]$CurAge <- ifelse(dat_adjusted[[i]]$CurAge < 1, 1, dat_adjusted[[i]]$CurAge)"
"0","  dat_adjusted[[i]]$Age <- ifelse(dat_adjusted[[i]]$Age > 94, 94, dat_adjusted[[i]]$Age)"
"0","  dat_adjusted[[i]]$Age <- ifelse(dat_adjusted[[i]]$Age < 1, 1, dat_adjusted[[i]]$Age)"
"0","  "
"0","  # Ensure dadid and momid are valid IDs"
"0","  valid_ids <- dat_adjusted[[i]]$ID"
"0","  "
"0","  dat_adjusted[[i]]$FatherID <- ifelse(dat_adjusted[[i]]$FatherID %in% valid_ids, dat_adjusted[[i]]$FatherID, NA)"
"0","  dat_adjusted[[i]]$MotherID <- ifelse(dat_adjusted[[i]]$MotherID %in% valid_ids, dat_adjusted[[i]]$MotherID, NA)"
"0","  "
"0","  # Check for any remaining invalid parent IDs and handle them"
"0","  if (any(is.na(dat_adjusted[[i]]$father) | is.na(dat_adjusted[[i]]$mother))) {"
"0","    warning(""Some individuals have invalid or missing father or mother IDs."")"
"0","  }"
"0","}"
"0",""
"0","# Initialize a counter for NA values"
"0","na_count <- 0"
"0",""
"0","# Loop through each data frame in the list"
"0","for(i in 1:length(dat_adjusted)) {"
"0","  # Add the count of NA values in the isAff column to na_count"
"0","  na_count <- na_count + sum(is.na(dat_adjusted[[i]]$CurAge))"
"0","}"
"0",""
"0","describeFamilies(dat_adjusted)"
"1","[1]"
"1"," ""Number of families: 1750"""
"1","
"
"1","[1]"
"1"," ""Total Individuals: 50969"""
"1","
"
"1","[1]"
"1"," ""Average family size: 29.1251428571429"""
"1","
"
"1","[1]"
"1"," ""Summary of family sizes"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","   1.00 "
"1","   8.00 "
"1","  23.00 "
"1","  29.13 "
"1","  42.00 "
"1"," 323.00 "
"1","
"
"1","[1]"
"1"," ""Summary of Current Age for all family members"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","   NA's "
"1","
"
"1","   1.00 "
"1","  27.00 "
"1","  47.00 "
"1","  47.23 "
"1","  66.00 "
"1","  94.00 "
"1","  43457 "
"1","
"
"1","[1]"
"1"," ""Number of individuals with NA Current Age (Male): 21788"""
"1","
"
"1","[1]"
"1"," ""Number of individuals with NA Current Age (Female): 21669"""
"1","
"
"1","[1]"
"1"," ""Summary of Current Age for probands"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","   NA's "
"1","
"
"1","   1.00 "
"1","  29.00 "
"1","  39.00 "
"1","  39.75 "
"1","  51.00 "
"1","  94.00 "
"1","    734 "
"1","
"
"1","[1]"
"1"," ""Number of affected individuals:459"""
"1","
"
"1","[1]"
"1"," ""Number of families with affected individuals: 322"""
"1","
"
"1","[1]"
"1"," ""Number of families with more than 1 affected individual: 93"""
"1","
"
"1","[1]"
"1"," ""Number of families with affected probands: 62"""
"1","
"
"1","[1]"
"1"," ""Number of families with affected female probands: 41"""
"1","
"
"1","[1]"
"1"," ""Number of families with affected male probands: 21"""
"1","
"
"1","[1]"
"1"," ""Number of families with relatives with PV (and not the proband): 665"""
"1","
"
"1","[1]"
"1"," ""Number of probands with PV: 1606"""
"1","
"
"1","[1]"
"1"," ""Number of female probands with PV: 38"""
"1","
"
"1","[1]"
"1"," ""Number of male probands with PV: 18"""
"1","
"
"1","[1]"
"1"," ""Number of individuals with PV: 111"""
"1","
"
"1","[1]"
"1"," ""Summary of Cancer Age of females (excl. probands)"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","   NA's "
"1","
"
"1","    9.0 "
"1","   43.0 "
"1","   57.0 "
"1","   55.9 "
"1","   69.5 "
"1","   94.0 "
"1","     24 "
"1","
"
"1","[1]"
"1"," ""Summary of Cancer Age of males (excl. probands)"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","   NA's "
"1","
"
"1","    1.0 "
"1","   47.5 "
"1","   58.0 "
"1","   57.5 "
"1","   70.0 "
"1","   94.0 "
"1","     39 "
"1","
"
"1","[1]"
"1"," ""Summary of Cancer Age of female probands"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","  15.00 "
"1","  32.00 "
"1","  42.00 "
"1","  40.93 "
"1","  48.00 "
"1","  71.00 "
"1","
"
"1","[1]"
"1"," ""Summary of Cancer Age of male probands"""
"1","
"
"1","   Min. "
"1","1st Qu. "
"1"," Median "
"1","   Mean "
"1","3rd Qu. "
"1","   Max. "
"1","
"
"1","  18.00 "
"1","  35.00 "
"1","  39.00 "
"1","  40.71 "
"1","  50.00 "
"1","  65.00 "
"1","
"
"1","[1]"
"1"," ""Number of individuals with NA Cancer Age (Male): 39"""
"1","
"
"1","[1]"
"1"," ""Number of individuals with NA Cancer Age (Female): 24"""
"1","
"
"2","Warning:"
"2"," [38;5;252mRemoved 43457 rows containing non-finite outside the scale range (`stat_bin()`).[39m
"
"2","Warning:"
"2"," [38;5;252mRemoved 2 rows containing missing values or values outside the scale range (`geom_bar()`).[39m
"
