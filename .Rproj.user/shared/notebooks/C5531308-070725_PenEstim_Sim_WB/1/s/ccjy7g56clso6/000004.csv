"0","library(penetrance)"
"2","Warning messages:
"
"2","1: package ‘ggplot2’ was built under R version 4.2.3 
"
"2","2: package ‘tidyr’ was built under R version 4.2.3 
"
"2","3: package ‘dplyr’ was built under R version 4.2.3 
"
"2","4: package ‘scales’ was built under R version 4.2.3 
"
"2","5: package ‘ggridges’ was built under R version 4.2.3 
"
"2","6: package ‘GGally’ was built under R version 4.2.3 
"
"0","# In the penetrance estimation section, replace with:"
"0","# Define a single sample size"
"0","sample_size <- 400 # You can adjust this value as needed"
"0",""
"0","# Define multiple seeds for the estimation procedure"
"0","estimation_seeds <- c(2024, 2025, 2026, 2027, 2028, 2029, 2030)"
"0",""
"0","# Function to run penetrance estimation with a specific seed"
"0","run_penetrance_estimation <- function(size, est_seed, n_iter = 10000, n_chains = 1, ncores = 1) {"
"0","  # Load the relevant data"
"0","  data_file <- file.path(results_dir, paste0(""reformatted_weibull_"", size, "".RData""))"
"0","  if (!file.exists(data_file)) {"
"0","    message(paste0(""Data file not found for sample size "", size))"
"0","    return(NULL)"
"0","  }"
"0",""
"0","  load(data_file) # loads 'reformatted_data'"
"0",""
"0","  # Define prior parameters"
"0","  prior_params <- list("
"0","    asymptote = list(g1 = 1, g2 = 1),"
"0","    threshold = list(min = 5, max = 40),"
"0","    median = list(m1 = 2, m2 = 2),"
"0","    first_quartile = list(q1 = 6, q2 = 3)"
"0","  )"
"0",""
"0","  message(paste0("
"0","    ""Running penetrance estimation for sample size "", size,"
"0","    "" with estimation seed "", est_seed, "" and "", n_iter, "" iterations"""
"0","  ))"
"0",""
"0","  # Set up progress tracking"
"0","  start_time <- Sys.time()"
"0",""
"0","  # Get allele frequency from PanelPRO database"
"0","  prev <- PanelPRO::PanelPRODatabase$AlleleFrequency[paste0(""MLH1"", ""_anyPV""), ""nonAJ""]"
"0",""
"0","  # Set the seed for the estimation procedure"
"0","  set.seed(est_seed)"
"0",""
"0","  # Add try-catch for error handling"
"0","  result <- tryCatch("
"0","    {"
"0","      # Call your penetrance function"
"0","      penetrance("
"0","        pedigree = reformatted_data,"
"0","        twins = NULL,"
"0","        n_chains = n_chains,"
"0","        n_iter_per_chain = n_iter,"
"0","        ncores = ncores,"
"0","        baseline_data = baseline_data_default,"
"0","        prev = prev,"
"0","        prior_params = prior_params_default,"
"0","        imp_interval = 10,"
"0","        burn_in = 0.1,"
"0","        median_max = TRUE,"
"0","        age_imputation = FALSE,"
"0","        remove_proband = FALSE"
"0","      )"
"0","    },"
"0","    error = function(e) {"
"0","      message(paste0(""Error in penetrance estimation for seed "", est_seed, "": "", e$message))"
"0","      return(NULL)"
"0","    }"
"0","  )"
"0",""
"0","  end_time <- Sys.time()"
"0","  time_taken <- difftime(end_time, start_time, units = ""mins"")"
"0","  message(paste0("
"0","    ""Completed penetrance estimation for seed "", est_seed,"
"0","    "" in "", round(time_taken, 2), "" minutes"""
"0","  ))"
"0",""
"0","  # Save the results with seed-specific naming"
"0","  if (!is.null(result)) {"
"0","    output_file <- file.path(results_dir, paste0(""out_sim_weibull_COL_MLH1_sim"", size, ""_estseed_"", est_seed, "".RData""))"
"0","    save(result, file = output_file)"
"0","    message(paste0(""Saved results to "", output_file))"
"0","  }"
"0",""
"0","  return(result)"
"0","}"
"0",""
"0","# Run the penetrance estimation for all seeds"
"0","results_list <- list()"
"0",""
"0","for (est_seed in estimation_seeds) {"
"0","  # Adjust iterations based on computational resources"
"0","  n_iter <- 5000"
"0","  n_chains <- 1"
"0",""
"0","  # Run estimation with this seed"
"0","  result <- run_penetrance_estimation(sample_size, est_seed, n_iter, n_chains, ncores = parallel::detectCores() - 1)"
"0",""
"0","  if (!is.null(result)) {"
"0","    set_name <- paste0(""est_seed_"", est_seed)"
"0","    results_list[[set_name]] <- result"
"0","  }"
"0","}"
"2","Running penetrance estimation for sample size 400 with estimation seed 2024 and 5000 iterations
"
"2","
"
"2","Execution halted

Execution halted

"
"2","
Execution halted
"
"2","Execution halted
"
"2","
"
"2","Execution halted

Execution halted
"
"2","
"
"2","Execution halted
"
