<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Inference using Independent Metropolis-Hastings for Penetrance Estimation — penetrance • penetrance</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Inference using Independent Metropolis-Hastings for Penetrance Estimation — penetrance"><meta name="description" content="This function implements the Independent Metropolis-Hastings algorithm for Bayesian
penetrance estimation of cancer risk. It utilizes parallel computing to run multiple
chains and provides various options for analyzing and visualizing the results."><meta property="og:description" content="This function implements the Independent Metropolis-Hastings algorithm for Bayesian
penetrance estimation of cancer risk. It utilizes parallel computing to run multiple
chains and provides various options for analyzing and visualizing the results."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">penetrance</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/simulation_study_real.html">Simulation study from empirical data with penetrance</a></li>
    <li><a class="dropdown-item" href="../articles/simulation_study.html">Simulation Study with penetrance</a></li>
    <li><a class="dropdown-item" href="../articles/using_penetrance.html">Using penetrance</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nicokubi/penetrance/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian Inference using Independent Metropolis-Hastings for Penetrance Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicokubi/penetrance/blob/HEAD/R/PenEstimMain.R" class="external-link"><code>R/PenEstimMain.R</code></a></small>
      <div class="d-none name"><code>penetrance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the Independent Metropolis-Hastings algorithm for Bayesian
penetrance estimation of cancer risk. It utilizes parallel computing to run multiple
chains and provides various options for analyzing and visualizing the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">penetrance</span><span class="op">(</span></span>
<span>  <span class="va">pedigree</span>,</span>
<span>  twins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_iter_per_chain <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  max_age <span class="op">=</span> <span class="fl">94</span>,</span>
<span>  baseline_data <span class="op">=</span> <span class="va">baseline_data_default</span>,</span>
<span>  removeProband <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ageImputation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  median_max <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  BaselineNC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  thinning_factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  distribution_data <span class="op">=</span> <span class="va">distribution_data_default</span>,</span>
<span>  af <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  max_penetrance <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ratio <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_params <span class="op">=</span> <span class="va">prior_params_default</span>,</span>
<span>  risk_proportion <span class="op">=</span> <span class="va">risk_proportion_default</span>,</span>
<span>  summary_stats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rejection_rates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  density_plots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_trace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  penetrance_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  penetrance_plot_pdf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  probCI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  sex_specific <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pedigree">pedigree<a class="anchor" aria-label="anchor" href="#arg-pedigree"></a></dt>
<dd><p>A data frame containing the pedigree data in the required format. It should include the following columns:</p><ul><li><p><code>PedigreeID</code>: A numeric value representing the unique identifier for each family. There should be no duplicated entries.</p></li>
<li><p><code>ID</code>: A numeric value representing the unique identifier for each individual. There should be no duplicated entries.</p></li>
<li><p><code>Sex</code>: A numeric value where <code>0</code> indicates female and <code>1</code> indicates male. Missing entries are not currently supported.</p></li>
<li><p><code>MotherID</code>: A numeric value representing the unique identifier for an individual's mother.</p></li>
<li><p><code>FatherID</code>: A numeric value representing the unique identifier for an individual's father.</p></li>
<li><p><code>isProband</code>: A numeric value where <code>1</code> indicates the individual is a proband and <code>0</code> otherwise.</p></li>
<li><p><code>CurAge</code>: A numeric value indicating the age of censoring (current age if the person is alive or age at death if the person is deceased). Allowed ages range from <code>1</code> to <code>94</code>.</p></li>
<li><p><code>isAff</code>: A numeric value indicating the affection status of cancer, with <code>1</code> for diagnosed individuals and <code>0</code> otherwise. Missing entries are not supported.</p></li>
<li><p><code>Age</code>: A numeric value indicating the age of cancer diagnosis, encoded as <code>NA</code> if the individual was not diagnosed. Allowed ages range from <code>1</code> to <code>94</code>.</p></li>
<li><p><code>Geno</code>: A column for germline testing or tumor marker testing results. Positive results should be coded as <code>1</code>, negative results as <code>0</code>, and unknown results as <code>NA</code> or left empty.</p></li>
</ul></dd>


<dt id="arg-twins">twins<a class="anchor" aria-label="anchor" href="#arg-twins"></a></dt>
<dd><p>A list specifying identical twins or triplets in the family. For example, to indicate that "ora024" and "ora027" are identical twins, and "aey063" and "aey064" are identical twins, use the following format: <code>twins &lt;- list(c("ora024", "ora027"), c("aey063", "aey064"))</code>.</p></dd>


<dt id="arg-n-chains">n_chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>Integer, the number of chains for parallel computation. Default is 1.</p></dd>


<dt id="arg-n-iter-per-chain">n_iter_per_chain<a class="anchor" aria-label="anchor" href="#arg-n-iter-per-chain"></a></dt>
<dd><p>Integer, the number of iterations for each chain. Default is 10000.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Integer, the number of cores for parallel computation. Default is 6.</p></dd>


<dt id="arg-max-age">max_age<a class="anchor" aria-label="anchor" href="#arg-max-age"></a></dt>
<dd><p>Integer, the maximum age considered for analysis. Default is 94.</p></dd>


<dt id="arg-baseline-data">baseline_data<a class="anchor" aria-label="anchor" href="#arg-baseline-data"></a></dt>
<dd><p>Data for the baseline risk estimates (probability of developing cancer), such as population-level risk from a cancer registry. Default data, for exemplary purposes, is for Colorectal cancer from the SEER database.</p></dd>


<dt id="arg-removeproband">removeProband<a class="anchor" aria-label="anchor" href="#arg-removeproband"></a></dt>
<dd><p>Logical, indicating whether to remove probands from the analysis. Default is FALSE.</p></dd>


<dt id="arg-ageimputation">ageImputation<a class="anchor" aria-label="anchor" href="#arg-ageimputation"></a></dt>
<dd><p>Logical, indicating whether to perform age imputation. Default is FALSE.</p></dd>


<dt id="arg-median-max">median_max<a class="anchor" aria-label="anchor" href="#arg-median-max"></a></dt>
<dd><p>Logical, indicating whether to use the baseline median age or <code>max_age</code> as an upper bound for the median proposal. Default is TRUE.</p></dd>


<dt id="arg-baselinenc">BaselineNC<a class="anchor" aria-label="anchor" href="#arg-baselinenc"></a></dt>
<dd><p>Logical, indicating that the non-carrier penetrance is assumed to be the baseline penetrance. Default is TRUE.</p></dd>


<dt id="arg-var">var<a class="anchor" aria-label="anchor" href="#arg-var"></a></dt>
<dd><p>Numeric vector, variances for the proposal distribution in the Metropolis-Hastings algorithm. Default is <code>c(0.1, 0.1, 2, 2, 5, 5, 5, 5)</code>.</p></dd>


<dt id="arg-burn-in">burn_in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>Numeric, the fraction of results to discard as burn-in (0 to 1). Default is 0 (no burn-in).</p></dd>


<dt id="arg-thinning-factor">thinning_factor<a class="anchor" aria-label="anchor" href="#arg-thinning-factor"></a></dt>
<dd><p>Integer, the factor by which to thin the results. Default is 1 (no thinning).</p></dd>


<dt id="arg-distribution-data">distribution_data<a class="anchor" aria-label="anchor" href="#arg-distribution-data"></a></dt>
<dd><p>Data for generating prior distributions.</p></dd>


<dt id="arg-af">af<a class="anchor" aria-label="anchor" href="#arg-af"></a></dt>
<dd><p>Numeric, allele frequency for the risk allele. Default is 0.0001.</p></dd>


<dt id="arg-max-penetrance">max_penetrance<a class="anchor" aria-label="anchor" href="#arg-max-penetrance"></a></dt>
<dd><p>Numeric, the maximum penetrance considered for analysis. Default is 1.</p></dd>


<dt id="arg-sample-size">sample_size<a class="anchor" aria-label="anchor" href="#arg-sample-size"></a></dt>
<dd><p>Optional numeric, sample size for distribution generation.</p></dd>


<dt id="arg-ratio">ratio<a class="anchor" aria-label="anchor" href="#arg-ratio"></a></dt>
<dd><p>Optional numeric, ratio parameter for distribution generation.</p></dd>


<dt id="arg-prior-params">prior_params<a class="anchor" aria-label="anchor" href="#arg-prior-params"></a></dt>
<dd><p>List, parameters for prior distributions.</p></dd>


<dt id="arg-risk-proportion">risk_proportion<a class="anchor" aria-label="anchor" href="#arg-risk-proportion"></a></dt>
<dd><p>Numeric, proportion of risk for distribution generation.</p></dd>


<dt id="arg-summary-stats">summary_stats<a class="anchor" aria-label="anchor" href="#arg-summary-stats"></a></dt>
<dd><p>Logical, indicating whether to include summary statistics in the output. Default is TRUE.</p></dd>


<dt id="arg-rejection-rates">rejection_rates<a class="anchor" aria-label="anchor" href="#arg-rejection-rates"></a></dt>
<dd><p>Logical, indicating whether to include rejection rates in the output. Default is TRUE.</p></dd>


<dt id="arg-density-plots">density_plots<a class="anchor" aria-label="anchor" href="#arg-density-plots"></a></dt>
<dd><p>Logical, indicating whether to include density plots in the output. Default is TRUE.</p></dd>


<dt id="arg-plot-trace">plot_trace<a class="anchor" aria-label="anchor" href="#arg-plot-trace"></a></dt>
<dd><p>Logical, indicating whether to include trace plots in the output. Default is TRUE.</p></dd>


<dt id="arg-penetrance-plot">penetrance_plot<a class="anchor" aria-label="anchor" href="#arg-penetrance-plot"></a></dt>
<dd><p>Logical, indicating whether to include penetrance plots in the output. Default is TRUE.</p></dd>


<dt id="arg-penetrance-plot-pdf">penetrance_plot_pdf<a class="anchor" aria-label="anchor" href="#arg-penetrance-plot-pdf"></a></dt>
<dd><p>Logical, indicating whether to include PDF plots in the output. Default is TRUE.</p></dd>


<dt id="arg-probci">probCI<a class="anchor" aria-label="anchor" href="#arg-probci"></a></dt>
<dd><p>Numeric, probability level for credible intervals in penetrance plots. Must be between 0 and 1. Default is 0.95.</p></dd>


<dt id="arg-sex-specific">sex_specific<a class="anchor" aria-label="anchor" href="#arg-sex-specific"></a></dt>
<dd><p>Logical, indicating whether to use sex-specific parameters in the analysis. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing combined results from all chains, including optional statistics and plots.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by BayesMendel Lab, Nicolas Kubista.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

