% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/imputeAges.R
\name{imputeAges}
\alias{imputeAges}
\title{Impute Missing Ages in Family-Based Data}
\usage{
imputeAges(
  data,
  na_indices,
  baseline_male = NULL,
  baseline_female = NULL,
  alpha_male = NULL,
  beta_male = NULL,
  delta_male = NULL,
  alpha_female = NULL,
  beta_female = NULL,
  delta_female = NULL,
  baseline = NULL,
  alpha = NULL,
  beta = NULL,
  delta = NULL,
  max_age,
  sex_specific = TRUE,
  max_attempts = 100,
  geno_freq,
  trans,
  lik
)
}
\arguments{
\item{data}{A data frame containing family-based data with columns: family, individual,
father, mother, sex, aff, age, geno, and isProband}

\item{na_indices}{Vector of indices where ages need to be imputed}

\item{baseline_male, baseline_female}{Data frames containing baseline age distributions for males/females}

\item{alpha_male, alpha_female}{Shape parameters for male/female Weibull distributions}

\item{beta_male, beta_female}{Scale parameters for male/female Weibull distributions}

\item{delta_male, delta_female}{Location parameters for male/female Weibull distributions}

\item{baseline}{Data frame containing overall baseline age distribution (non-sex-specific)}

\item{alpha, beta, delta}{Overall Weibull parameters (non-sex-specific)}

\item{max_age}{Maximum allowable age}

\item{sex_specific}{Logical; whether to use sex-specific parameters}

\item{max_attempts}{Maximum number of attempts for generating valid ages}

\item{geno_freq}{Vector of genotype frequencies}

\item{trans}{Transmission probabilities}

\item{lik}{Likelihood matrix}
}
\value{
A data frame with the following modifications:
\item{age}{Updated with imputed ages for previously missing values}
The rest of the data frame remains unchanged.
}
\description{
Imputes missing ages in family-based data using a combination of Weibull distributions
for affected individuals and empirical distributions for unaffected individuals.
The function can perform both sex-specific and non-sex-specific imputations.
}
\examples{
# Create sample data
data <- data.frame(
  family = c(1,1),
  individual = c(1,2),
  sex = c(1,2),
  aff = c(1,0),
  age = c(NA,NA),
  geno = c("1/2",NA)
)
na_indices <- which(is.na(data$age))
geno_freq <- c(0.999, 0.001)
trans <- matrix(c(1,0,0.5,0.5), nrow=2)
lik <- matrix(1, nrow=nrow(data), ncol=2)

# Create baseline data
baseline <- data.frame(
  age = 20:94,
  cum_prob = (1:75)/75
)

# Impute ages
\dontrun{
imputed_data <- imputeAges(
  data = data,
  na_indices = na_indices,
  max_age = 94,
  baseline = baseline,  # Add baseline data
  geno_freq = geno_freq,
  trans = trans,
  lik = lik,
  sex_specific = FALSE  # Use non-sex-specific imputation for example
)
}
}
